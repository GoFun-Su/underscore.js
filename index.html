<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
		.share-list{
    display: flex;
}
.share-item{
    width: 60px;
    height: 60px;
}
.gap{
    flex: 1;
    width: 1%;
}
	</style>
</head>
<body>
	<ul class="share-list">
    <li class="gap"></li>
    <li class="share-item"></li>
    <li class="gap"></li>
    <li class="share-item"></li>
    <li class="gap"></li>
    <li class="share-item"></li>
    <li class="gap"></li>
</ul>

<script type="text/javascript" src="index.js"></script>
<script type="text/javascript">
	/* var cb = function(value, context, argCount) {
    if (_.iteratee !== builtinIteratee) return _.iteratee(value, context);
    if (value == null) return _.identity;
    if (_.isFunction(value)) return optimizeCb(value, context, argCount);
    if (_.isObject(value) && !_.isArray(value)) return _.matcher(value);
    return _.property(value);
  };*/
 /*function(obj) {
      return obj == null ? void 0 : obj[key];
    };
  };*/
  	var func = function(greeting){ return greeting + ': ' + this.name };
	func = _.bind(func, {name: 'moe'}, 'hi');

func()
	/*function Person (name){
		this.name = name;
	}
	Person.prototype.setName = function(name) {
		this.name = name;
	}
	Person.prototype.getName = function() {
		return this.name;
	}

	function Teacher(){

	}
	Teacher.prototype = new Person();
	Teacher.prototype.setName = function(name) {
		this.name = "23"
	}
	Teacher.prototype.getName = function(name) {
		return this.name;
	}

	var p = new Teacher();
	p.setName("wee");
	alert(p.getName())*/

	/*function List() {
		this.list = [];
	}
	List.prototype.add= function(o) {
		this.list.push(o);
	};
	List.prototype.count= function() {
		return this.list.length;
	};

	List.prototype.get = function(index) {
		if (index>-1 && index < this.list.length) {
			return this.list[index]
		}
	}
	List.prototype.indexOf = function(obj,startIndex){
		var i = startIndex;
		while(i < this.list.length) {
			if (this.list[i] === obj) {
				return i;
			}
			i ++;
		}
		return -1;
	}

	List.prototype.remove = function(index) {
		this.subscriberList.splice(index,1);
	}


	function Item() {
		this.objs = new List();
	}

	Item.prototype.addList = function(o){
		this.objs.add(o);
	}
	
	Item.prototype.setContext = function(text) {
		this.context = text;
		this.notify();
	}
	Item.prototype.notify = function(){
		let count = this.objs.count();
		for(var i = 0; i < count; i ++) {
			this.objs.get(i).update(this.context); //observerList[i].update(this.state);
		}
	}
	
	function Sub() {
		this.update = function(data){
                  console.log(data);
            };
		}

	var p1 = new Sub();
	var p2 = new Sub();
	var o = new Item();
	o.addList(p1);
	o.addList(p2);
	o.setContext("这是第一条订阅的消息") //更新消息并发布
	pb1.update = function(data) {
		console.log("订阅消息"+data)
	}

 	pb2.update = function(data) {
 		console.log("订阅消息"+data)
 	}*/

 	/*var shallowProperty = function(key) {
       return function(obj) {
          return obj == null ? void 0 : obj[key];
        };
    };
    var getLength = shallowProperty('length');

   
    console.log(getLength(
    	function name(na){}
    	)
    )
    var p = function name(na){}
    	console.log(p["length"])*/
   /* reduce函数解析
   var _ = {};
      _.keys = function(obj) {
    
    var keys = [];
    	for (var key in obj) keys.push(key);
    	return keys;
  	};
    var optimizeCb = function(func, context, argCount) {
    	if (context === void 0) return func;
    	switch (argCount) {
      		case 1: return function(value) {
        		return func.call(context, value);
      		};
      
      		case null:
      		case 3: return function(value, index, collection) {
        		return func.call(context, value, index, collection);
      		};
      		case 4: return function(accumulator, value, index, collection) {
        		return func.call(context, accumulator, value, index, collection);
      		};
    	}
    	return function() {
      		return func.apply(context, arguments);
    	};
  };
    var createReduce = function(dir) {
        var reducer = function(obj, iteratee, memo, initial) {
            length = obj.length,
          
            index = dir > 0 ? 0 : length - 1;
            
            //依次循环
            for (; index >= 0 && index < length; index += dir) {
                var currentKey = index;
                memo = iteratee(memo, obj[currentKey], currentKey, obj);
                console.log(memo)
            }

            return memo;
        };

        return function(obj, iteratee, memo, context) {
            var initial = arguments.length >= 3;
            return reducer(obj, optimizeCb(iteratee, context, 4), memo, initial);
        };
    };
     _.reduce = createReduce(-1);
     var list = [[0, 1], [2, 3], [4, 5]];
	var flat = _.reduce(list, function(a, b) { return a.concat(b); }, []);*/
	



//函数的 length 得到的是形参个数,arguments.length为实参的个数
var func = function(greeting){ return greeting + ': ' + this.name };
	func = _.bind(func, {name: 'moe'}, 'hi');
	func();
var callback1 = function(func, context, args) {
        if (!_.isFunction(func)) throw new TypeError('Bind must be called on a function');
        var bound = restArgs(function(callArgs) {
                return executeBound(func, bound, context, this, args.concat(callArgs));
        });
        return bound;
};
 _.bind = restArgs(callback1); 
 var restArgs = function(func, startIndex) {
        startIndex = startIndex == null ? func.length - 1 : +startIndex;
        startIndex = 3-1=2;
        return function() {
            var length = Math.max(arguments.length - 2, 0),
            rest = Array(length),
            index = 0;
            for (; index < length; index++) {
              rest[index] = arguments[index + 2];
            }
            switch (2) {
                case 2: return callback1.call(this, arguments[0], arguments[1], rest);
            }
            
    };
 };
 func = _.bind(func, {name: 'moe'}, 'hi');
 _.bind = function() {
            var length = Math.max(3- 2, 0),
            rest = Array(1),
            index = 0;
            for (; index < 1; index++) {
              rest[0] = arguments[0 + 2];
            }
            switch (2) {
                case 2: return callback1(func, {name: 'moe'}, ['hi']);
            }
            
    };; 
func = _.bind(func, {name: 'moe'}, ['hi']);
//调用成功之后-->
callback1(func, {name: 'moe'}, ['hi'])
//改个名字
bind2(func, {name: 'moe'}, ['hi'])


bind2(func, {name: 'moe'}, ['hi'])
var bind2 = function(func, context, args) {
        var bound = restArgs(function(callArgs) {
                return executeBound(func, bound, context, this, args.concat(callArgs));
        });
        return bound;
};
var callback2 = function(callArgs) {
        return executeBound(func, bound, {name: 'moe'}, this, ['hi'].concat(callArgs));
};
bind2(func, {name: 'moe'}, ['hi'])
var bind2 = function(func, context, args) {
        var bound = restArgs(callback2);
        return bound;
};
var restArgs = function(func, startIndex) {
        startIndex = startIndex == null ? func.length - 1 : +startIndex;
        startIndex = 1-1=0;
        return function() {
            var length = Math.max(arguments.length - 0, 0),
            //生成一个数组，长度为length
            rest = Array(length),
            index = 0;
            for (; index < length; index++) {
              rest[index] = arguments[index + 0];
            }
            switch (0) {
                case 0: return callback2.call(this, rest);
            }
        };
    };
bind2(func, {name: 'moe'}, ['hi'])
var bind2 = function(func, context, args) {
        var bound = function() {
            	var length = Math.max(arguments.length - 0, 0),
            	rest = Array(length),
            	index = 0;
            	for (; index < length; index++) {
              		rest[index] = arguments[index + 0];
            	}
            	
                return callback2.call(this, rest);
            }
       	 };
        return bound;
};
var p =bind2(func, {name: 'moe'}, ['hi'])
var bind2 = function(func, context, args) {
      return   function() {
            	var length = Math.max(arguments.length - 0, 0),
            	rest = Array(length),
            	index = 0;
            	for (; index < length; index++) {
              		rest[index] = arguments[index + 0];
            	}
            	
                return callback2.call(this, rest);
            }
       	 };
};
function() {
	var length = Math.max(arguments.length - 0, 0),
	rest = Array(length),
	index = 0;
	for (; index < length; index++) {
  		rest[index] = arguments[index + 0];
	}
	
    return callback2.call(this, rest);
};
p();
function() {
	var length = Math.max(0 - 0, 0),
	rest = Array(0),
	index = 0;
	for (; index < length; index++) {
  		rest[index] = arguments[index + 0];
	}
	
    return callback2([]);
};
-->callback2([])
var callback2 = function(callArgs) {
        return executeBound(func, bound, {name: 'moe'}, this, ['hi']);
};
-->callback2([])
-->func.apply({name: 'moe'}, ['hi'])
-->var func = function(greeting){ return greeting + ': ' + this.name };
-->func.apply({name: 'moe'}, ['hi'])
"hi: moe"
</script>
</html>